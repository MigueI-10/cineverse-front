import{b as G}from"./chunk-JJSDBTMF.js";import{b as ee}from"./chunk-DHQ6GAFJ.js";import{z as Z}from"./chunk-MG4W3XTZ.js";import{A as K,B as Q,E as X,F as Y,a as v,b as h,z as J}from"./chunk-LNHBMWTA.js";import"./chunk-7B4WEPGY.js";import{a as W}from"./chunk-VK4RGVHF.js";import{a as M,b as q,i as H}from"./chunk-ROIV5QGY.js";import{$b as D,Ab as L,Bb as T,Cb as s,D as x,Db as c,Eb as S,Ib as y,Kb as U,Lb as l,Ob as F,Tc as R,Ua as P,Vb as f,Wb as A,Xb as B,Ya as m,Yb as $,Za as d,Zb as V,_ as I,_b as z,ac as N,c as w,da as j,ja as k,n as g,pb as p,r as _,rb as E,sa as C,ta as b,xb as u,yb as O}from"./chunk-VZFTKLKS.js";var te=(()=>{let o=class o{constructor(t){this.http=t,this.urlBackEnd=W.baseUrl}findFavoritesFromUser(t){let i=localStorage.getItem("token"),n=new M().set("Authorization",`Bearer ${i}`);return this.http.get(`${this.urlBackEnd}/favorite/user-favorite/${t}`,{headers:n}).pipe(_(a=>a),x(a=>(console.log(a),g([]))))}deleteFavorite(t){let i=localStorage.getItem("token"),n=new M().set("Authorization",`Bearer ${i}`);return this.http.delete(`${this.urlBackEnd}/favorite/${t}`,{headers:n}).pipe(_(()=>!0),x(a=>(console.log("Error al eliminar favorito. "+a),g(!1))))}};o.\u0275fac=function(i){return new(i||o)(j(q))},o.\u0275prov=I({token:o,factory:o.\u0275fac,providedIn:"root"});let e=o;return e})();function ne(e,o){if(e&1&&(s(0,"span",6),f(1),c()),e&2){let r=l().$implicit;m(),B("Nota Personal: ",r.notaUsuario,"")}}function ae(e,o){e&1&&(s(0,"span",6),f(1,"Aun no has votado esta pel\xEDcula"),c())}function se(e,o){if(e&1){let r=y();s(0,"div",1)(1,"div",2),S(2,"img",3),c(),s(3,"div",4)(4,"h2",5),f(5),c(),p(6,ne,2,1,"span",6)(7,ae,2,0),s(8,"button",7),U("click",function(i){let n=C(r).$implicit,a=l(2);return b(a.deleteFavorite(n._id,i))}),f(9,"Eliminar de Favoritos"),c()()()}if(e&2){let r=o.$implicit;m(2),F("src",r.imagen,P),F("alt",r.titulo),m(3),A(r.titulo),m(),u(6,r.notaUsuario?6:7)}}function ce(e,o){if(e&1&&L(0,se,10,4,"div",1,O),e&2){let r=l();T(r.favoriteList)}}function le(e,o){if(e&1){let r=y();s(0,"p-messages",9),z("valueChange",function(i){C(r);let n=l(2);return V(n.mensaje,i)||(n.mensaje=i),b(i)}),c()}if(e&2){let r=l(2);$("value",r.mensaje),E("enableService",!1)("closable",!1)}}function me(e,o){if(e&1&&p(0,le,1,3,"p-messages",8),e&2){let r=l();u(0,r.showMessage?0:-1)}}var Ie=(()=>{let o=class o{constructor(t,i,n,a,ie){this._favService=t,this._authService=i,this._router=n,this.confirmationService=a,this.messageService=ie,this.idUser="",this.favoriteList=[],this.showMessage=!1,this.mensaje=[]}ngOnInit(){this.mensaje=[{severity:"info",summary:"Info",detail:"No hay resultados para este t\xE9rmino de b\xFAsqueda"}],this._authService.checkAuthStatus().subscribe(t=>{if(t){let i=w(this._authService.usrActual(),[]);this.idUser=i._id,this.getFavoriteList()}})}deleteFavorite(t,i){t!==""&&this.confirmationService.confirm({target:i.target,message:"Seguro que quieres borrarlo de tus favoritos?",header:"Accion Importante",icon:"pi pi-exclamation-triangle",acceptIcon:"none",rejectIcon:"none",rejectButtonStyleClass:"p-button-text",acceptLabel:"Si",rejectLabel:"No",accept:()=>{this._favService.deleteFavorite(t).subscribe(n=>{n?this.success("Favorito eliminado correctamente"):this.errorToast("Error al eliminar el favorito"),this.idUser&&(this.favoriteList=[],this.getFavoriteList())})},reject:()=>{this.messageService.add({severity:"info",summary:"Informacion",detail:"No se ha borrado el favorito",life:3e3})}})}getFavoriteList(){this._favService.findFavoritesFromUser(this.idUser).subscribe(t=>{t.length>0?this.favoriteList=t:this.showMessage=!0})}success(t){this.messageService.add({severity:"success",summary:"Success",detail:t})}errorToast(t){this.messageService.add({severity:"error",summary:"Error",detail:t})}};o.\u0275fac=function(i){return new(i||o)(d(te),d(G),d(H),d(v),d(h))},o.\u0275cmp=k({type:o,selectors:[["app-favorites"]],standalone:!0,features:[D([h,v]),N],decls:8,vars:1,consts:[[1,"favoritos"],[1,"card"],[1,"left"],[1,"card-image",3,"src","alt"],[1,"right"],[1,"card-title"],[1,"rating"],[1,"btn-delete","delete",3,"click"],[3,"value","enableService","closable"],[3,"valueChange","value","enableService","closable"]],template:function(i,n){i&1&&(s(0,"h2"),f(1,"Consulta entre tus favoritos y todas tus valoraciones hechas"),c(),S(2,"hr")(3,"p-toast")(4,"p-confirmDialog"),s(5,"div",0),p(6,ce,2,0)(7,me,1,1),c()),i&2&&(m(6),u(6,n.favoriteList.length>0?6:7))},dependencies:[R,Y,K,Q,X,Z,J,ee],styles:[".favoritos[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.card[_ngcontent-%COMP%]{background-color:#f9f9f9;border-radius:15px;overflow:hidden;box-shadow:0 4px 8px #0000001a;transition:box-shadow .3s ease;display:flex;flex-direction:row;padding:.5em}.left[_ngcontent-%COMP%]{flex:1}.right[_ngcontent-%COMP%]{text-align:center;flex:2;display:flex;flex-direction:column;justify-content:space-between}.card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 16px #0003}.card-image[_ngcontent-%COMP%]{width:80%;border-radius:15px}.delete[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto}.card-content[_ngcontent-%COMP%]{padding:1rem}.card-title[_ngcontent-%COMP%]{color:#000;margin-bottom:.5rem;font-size:1rem;transition:color .3s ease,text-shadow .3s ease}.card-title[_ngcontent-%COMP%]:hover{color:#007bff;cursor:pointer;text-shadow:0 0 8px #007bff}.card-details[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.rating[_ngcontent-%COMP%]{color:#28a745;font-size:1rem}.btn-delete[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff;border:none;border-radius:5px;padding:.5rem 1rem;cursor:pointer;transition:background-color .3s ease}.btn-delete[_ngcontent-%COMP%]:hover{background-color:#c82333}"]});let e=o;return e})();export{Ie as FavoritesComponent};
