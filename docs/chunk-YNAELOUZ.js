import{a as _e}from"./chunk-NO5I7SPA.js";import{a as oe,b as ne,c as ae,d as le,e as me,f as de,g as se,h as ce,t as ue,u as pe,z as fe}from"./chunk-MG4W3XTZ.js";import{A as ie,F as re,b as C,e as O,f as m,h as R,i as B,k as v,m as G,n as $,o as J,p as U,q as H,r as K,s as Q,t as W,u as X,v as Y,x as Z,y as ee,z as te}from"./chunk-LNHBMWTA.js";import"./chunk-7B4WEPGY.js";import{a as w}from"./chunk-2NBET2DA.js";import"./chunk-VK4RGVHF.js";import{g as P,i as j}from"./chunk-ROIV5QGY.js";import{$b as q,Ab as F,Bb as y,Cb as r,Db as t,Eb as p,Ib as T,Kb as g,Lb as M,Mc as D,Nc as L,Sc as k,Tc as z,Vb as n,Wb as I,Ya as d,Za as h,ac as N,hc as A,ic as V,ja as E,pb as c,rb as f,sa as S,ta as b,xb as u,yb as x}from"./chunk-VZFTKLKS.js";function Me(e,l){e&1&&n(0," A\xF1adir Pelicula ")}function ve(e,l){e&1&&n(0," Actualizar Pelicula ")}function Ce(e,l){e&1&&(r(0,"mat-error",6),n(1,"El titulo es obligatorio"),t())}function Ee(e,l){e&1&&(r(0,"mat-error",6),n(1,"Minimo 3 letras"),t())}function Se(e,l){e&1&&(r(0,"mat-error",6),n(1,"La imagen es obligatoria"),t())}function be(e,l){if(e&1&&(r(0,"option",14),n(1),t()),e&2){let s=l.$implicit;f("value",s._id),d(),I(s.nombre)}}function xe(e,l){e&1&&(r(0,"div",28),n(1," Debes a\xF1adir al menos 3 actores. "),t())}function Fe(e,l){e&1&&(r(0,"span",31),n(1,"Este campo es requerido"),t())}function ye(e,l){if(e&1){let s=T();r(0,"div",11)(1,"div",12),p(2,"input",29),r(3,"button",30),g("click",function(){let a=S(s).index,i=M();return b(i.onDeleteMovie(a))}),n(4,"Eliminar"),t()(),c(5,Fe,2,0,"span",31),t()}if(e&2){let s=l.index,o=M();d(2),f("formControlName",s)("disabled",!0),d(3),u(5,o.isValidFieldInArray(o.actores,s)?5:-1)}}function Te(e,l){e&1&&(r(0,"mat-error",6),n(1,"El tipo es obligatorio"),t())}function Ie(e,l){e&1&&(r(0,"mat-error",6),n(1,"El director es obligatorio"),t())}function qe(e,l){e&1&&(r(0,"mat-error",6),n(1,"Minimo 5 letras"),t())}function Ne(e,l){e&1&&(r(0,"mat-error",6),n(1,"El a\xF1o es obligatorio"),t())}function Ae(e,l){e&1&&(r(0,"mat-error",6),n(1,"El a\xF1o minimo es 1920"),t())}function Ve(e,l){e&1&&(r(0,"mat-error",6),n(1,"El a\xF1o maximo es 2028"),t())}function De(e,l){e&1&&(r(0,"mat-error",6),n(1,"La puntuacion es obligatoria"),t())}function Le(e,l){e&1&&(r(0,"mat-error",6),n(1,"El valor minimo es 0"),t())}function ke(e,l){e&1&&(r(0,"mat-error",6),n(1,"El valor maximo es 10"),t())}function ze(e,l){e&1&&(r(0,"mat-error",6),n(1,"El genero es obligatorio"),t())}function Pe(e,l){e&1&&(r(0,"mat-error",6),n(1,"El argumento es obligatorio"),t())}function je(e,l){e&1&&(r(0,"mat-error",6),n(1,"Minimo 30 caracteres"),t())}function we(e,l){e&1&&(r(0,"mat-error",6),n(1,"La duracion es obligatoria"),t())}function Oe(e,l){e&1&&(r(0,"mat-error",6),n(1,"El valor minimo es 0"),t())}function Re(e,l){e&1&&(r(0,"mat-error",6),n(1,"El valor maximo es 500"),t())}function Be(e,l){if(e&1&&(r(0,"mat-form-field",3)(1,"mat-label"),n(2,"Duracion de la pelicula"),t(),p(3,"input",32),c(4,we,2,0,"mat-error",6)(5,Oe,2,0)(6,Re,2,0),t()),e&2){let s=M();d(4),u(4,s.duracion.errors!=null&&s.duracion.errors.required?4:s.duracion.errors!=null&&s.duracion.errors.min?5:s.duracion.errors!=null&&s.duracion.errors.max?6:-1)}}function Ge(e,l){e&1&&(r(0,"mat-error",6),n(1,"Los episodios son obligatoria"),t())}function $e(e,l){e&1&&(r(0,"mat-error",6),n(1,"El valor minimo es 0"),t())}function Je(e,l){e&1&&(r(0,"mat-error",6),n(1,"El valor maximo es 5000"),t())}function Ue(e,l){if(e&1&&(r(0,"mat-form-field",3)(1,"mat-label"),n(2,"Episodios de la serie"),t(),p(3,"input",33),c(4,Ge,2,0,"mat-error",6)(5,$e,2,0)(6,Je,2,0),t()),e&2){let s=M();d(4),u(4,s.episodios.errors!=null&&s.episodios.errors.required?4:s.episodios.errors!=null&&s.episodios.errors.min?5:s.episodios.errors!=null&&s.episodios.errors.max?6:-1)}}var ft=(()=>{let l=class l{constructor(o,a,i,_,he,ge){this.fb=o,this._mediaService=a,this._router=i,this._activeRouter=_,this.messageService=he,this._actorService=ge,this.tipos=["pelicula","serie"],this.isSerie=!1,this.isPelicula=!1,this.actorList=new v("",[m.required])}ngOnInit(){this.cargarActoresBD(),this.frmMedia=this.fb.group({id:new v({value:"",disabled:!0}),titulo:["Uncharted",[m.required,m.minLength(3)]],tipo:["",m.required],imagen:["https://image.tmdb.org/t/p/w500//6hlI9Ea1O4IeJ2cj7OiNinqg8Qd.jpg",[m.required]],director:["Ridley Scott",[m.required,m.minLength(5)]],anyo:["2024",[m.required,m.min(1920),m.max(2028)]],genero:["Accion",[m.required]],descripcion:["La saga se enfoca en un personaje llamado Nathan Drake un aventurero caza tesoros que, a lo largo de los juegos, se embarca en diferentes aventuras junto a su fiel amigo y socio Victor Sullivan y sus intereses amorosos Elena Fisher y Chloe Frazer.",[m.required,m.minLength(30)]],puntuacion:["",[m.required,m.min(0),m.max(10)]],actores:this.fb.array([],[m.required,m.minLength(3)])}),this._activeRouter.params.subscribe(o=>{this.idMedia=o.id,this.idMedia&&(console.log(this.idMedia),this.cargarMedia())})}cargarMedia(){this._mediaService.getMediaById(this.idMedia).subscribe(o=>{o?(console.log(o),this.frmMedia.controls.id.setValue(o._id),this.frmMedia.controls.titulo.setValue(o.titulo),this.frmMedia.controls.tipo.setValue(o.tipo),this.frmMedia.controls.imagen.setValue(o.imagen),this.frmMedia.controls.director.setValue(o.director),this.frmMedia.controls.anyo.setValue(o.anyo),this.frmMedia.controls.genero.setValue(o.genero),this.frmMedia.controls.puntuacion.setValue(o.puntuacion),console.log(o.duracion),o.duracion?(this.clickTipo("pelicula"),this.frmMedia.controls.duracion.setValue(o.duracion)):o.episodios&&(this.clickTipo("serie"),this.frmMedia.controls.episodios.setValue(o.episodios)),this.actores.clear(),o.actores.forEach(a=>{let i=this.fb.control(a._id,m.required);i.disable(),this.actores.push(i)})):(this.errorToast("El actor no existe"),this._router.navigate(["/actores-crud"]))})}onAddMovie(){if(this.actorList.invalid)return;let o=this.actorList.value,a=this.fb.control(o,m.required);a.disable(),this.actores.push(a),this.actLocal=this.actLocal.filter(i=>i._id!==o),this.actorList.reset()}onDeleteMovie(o){this.actores.removeAt(o)}isValidFieldInArray(o,a){return o.controls[a].errors&&o.controls[a].touched}clickTipo(o){console.log(o),o=="serie"?(this.isPelicula=!1,this.isSerie=!0,this.frmMedia.contains("duracion")&&this.frmMedia.removeControl("duracion"),this.frmMedia.addControl("episodios",new v("",[m.required,m.min(0),m.max(5e3)]))):o=="pelicula"&&(this.isSerie=!1,this.isPelicula=!0,this.frmMedia.contains("episodios")&&this.frmMedia.removeControl("episodios"),this.frmMedia.addControl("duracion",new v("",[m.required,m.min(0),m.max(500)])))}cargarActoresBD(){let o=localStorage.getItem("actores");o!==null?this.actLocal=JSON.parse(o):this._actorService.getAllActors().subscribe(a=>{a.length<=0||(this.actLocal=a)})}saveMedia(){this.id.value==""?this.a\u00F1adirMedia():this.updateMedia()}a\u00F1adirMedia(){if(this.frmMedia.valid)if(this.actores.value.length>=3){let a=this.frmMedia.value;a.anyo=Number.parseInt(a.anyo),a.puntuacion=Number.parseInt(a.puntuacion),a.actores=this.actores.value,console.log(a),this._mediaService.addMedia(a).subscribe(i=>{i?this.success(`${a.tipo} a\xF1adida correctamente`):this.errorToast(`Fallo al a\xF1adir ${a.tipo}`),setTimeout(()=>{this.frmMedia.reset(),this._router.navigate(["/media-crud"])},2500)})}else this.errorToast("Debes seleccionar minimo 3 actores")}updateMedia(){if(this.frmMedia.valid)if(this.actores.value.length>=3){let a=this.frmMedia.value;a.anyo=Number.parseInt(a.anyo),a.puntuacion=Number.parseInt(a.puntuacion),a.actores=this.actores.value,console.log(a);let i=this.frmMedia.controls.id.value;this._mediaService.updateMedia(a,i).subscribe(_=>{_?this.success(`${a.tipo} actualizada correctamente`):this.errorToast(`Fallo al actualizar ${a.tipo}`),setTimeout(()=>{this.frmMedia.reset(),this._router.navigate(["/media-crud"])},2500)})}else this.errorToast("Debes seleccionar minimo 3 actores")}get id(){return this.frmMedia.get("id")}get titulo(){return this.frmMedia.get("titulo")}get imagen(){return this.frmMedia.get("imagen")}get tipo(){return this.frmMedia.get("tipo")}get director(){return this.frmMedia.get("director")}get anyo(){return this.frmMedia.get("anyo")}get genero(){return this.frmMedia.get("genero")}get descripcion(){return this.frmMedia.get("descripcion")}get duracion(){return this.frmMedia.get("duracion")}get episodios(){return this.frmMedia.get("episodios")}get puntuacion(){return this.frmMedia.get("puntuacion")}get actores(){return this.frmMedia.get("actores")}success(o){this.messageService.add({severity:"success",summary:"Success",detail:o})}errorToast(o){this.messageService.add({severity:"error",summary:"Error",detail:o})}};l.\u0275fac=function(a){return new(a||l)(h(Z),h(w),h(j),h(P),h(C),h(_e))},l.\u0275cmp=E({type:l,selectors:[["app-media-frm"]],standalone:!0,features:[q([C]),N],decls:87,vars:18,consts:[[1,"grid"],[1,"col-12","sm:col-6"],[3,"submit","formGroup"],[1,"m-2","col-12"],["matInput","","formControlName","id"],["type","text","matInput","","placeholder","Introduzca el titulo de la pelicula","formControlName","titulo","required",""],[1,"text-danger","font-italic"],["type","text","matInput","","placeholder","Imagen del Actor","formControlName","imagen","required",""],[1,"mb-3","row"],[1,"col-sm-3","col-form-label"],[1,"col-sm-9"],[1,"mb-1"],[1,"input-group"],[1,"form-control",3,"formControl"],[3,"value"],["type","button",1,"btn","btn-outline-primary",3,"click"],["class","text-danger",4,"ngIf"],["formArrayName","actores",1,"col-sm-9"],["class","mb-1",4,"ngFor","ngForOf"],["formControlName","tipo","placeholder","Selecciona el tipo"],["value","pelicula",3,"click"],["value","serie",3,"click"],["type","text","matInput","","placeholder","Introduzca el director de la pelicula","formControlName","director","required",""],["type","number","matInput","","placeholder","Introduzca el a\xF1o de la pelicula","formControlName","anyo","required",""],["type","number","matInput","","placeholder","Introduzca la puntuacion de la pelicula","formControlName","puntuacion","required",""],["type","text","matInput","","placeholder","Introduzca el genero de la pelicula","formControlName","genero","required",""],["type","text","matInput","","placeholder","Introduzca el argumento de la pelicula","formControlName","descripcion","required",""],["mat-flat-button","","color","primary",3,"disabled"],[1,"text-danger"],[1,"form-control",3,"formControlName","disabled"],["type","button",1,"btn","btn-outline-danger",3,"click"],[1,"form-text","text-danger"],["type","number","matInput","","placeholder","Introduzca la duracion de la pelicula","formControlName","duracion","required",""],["type","number","matInput","","placeholder","Introduzca la duracion de la pelicula","formControlName","episodios","required",""]],template:function(a,i){a&1&&(r(0,"h1"),c(1,Me,1,0)(2,ve,1,0),t(),r(3,"div",0)(4,"div",1)(5,"mat-card-content"),p(6,"p-toast"),r(7,"form",2),g("submit",function(){return i.saveMedia()}),r(8,"mat-form-field",3)(9,"mat-label"),n(10,"Id"),t(),p(11,"input",4),t(),r(12,"mat-form-field",3)(13,"mat-label"),n(14,"Titulo de la pel\xEDcula"),t(),p(15,"input",5),c(16,Ce,2,0,"mat-error",6)(17,Ee,2,0),t(),r(18,"mat-form-field",3)(19,"mat-label"),n(20,"Introduzca la imagen"),t(),p(21,"input",7),c(22,Se,2,0,"mat-error",6),t(),r(23,"div",8)(24,"label",9),n(25,"A\xF1ade 3 actores"),t(),r(26,"div",10)(27,"div",11)(28,"div",12)(29,"select",13),F(30,be,2,2,"option",14,x),t(),r(32,"button",15),g("click",function(){return i.onAddMovie()}),n(33,"Agregar actor"),t()()()()(),c(34,xe,2,0,"div",16),r(35,"div",8)(36,"label",9),n(37,"Pel\xEDculas"),t(),r(38,"div",17),c(39,ye,6,3,"div",18),A(40,"keyvalue"),t()(),r(41,"mat-form-field",3)(42,"mat-label"),n(43,"Tipo de Insercion"),t(),r(44,"mat-select",19)(45,"mat-option",20),g("click",function(){return i.clickTipo("pelicula")}),n(46,"Pelicula"),t(),r(47,"mat-option",21),g("click",function(){return i.clickTipo("serie")}),n(48,"Serie"),t()(),c(49,Te,2,0,"mat-error",6),t(),r(50,"mat-form-field",3)(51,"mat-label"),n(52,"Director de la pel\xEDcula"),t(),p(53,"input",22),c(54,Ie,2,0,"mat-error",6)(55,qe,2,0),t(),r(56,"mat-form-field",3)(57,"mat-label"),n(58,"A\xF1o de la pelicula"),t(),p(59,"input",23),c(60,Ne,2,0,"mat-error",6)(61,Ae,2,0)(62,Ve,2,0),t(),r(63,"mat-form-field",3)(64,"mat-label"),n(65,"Puntuacion de la pelicula"),t(),p(66,"input",24),c(67,De,2,0,"mat-error",6)(68,Le,2,0)(69,ke,2,0),t(),r(70,"mat-form-field",3)(71,"mat-label"),n(72,"Genero de la pel\xEDcula"),t(),p(73,"input",25),c(74,ze,2,0,"mat-error",6),t(),r(75,"mat-form-field",3)(76,"mat-label"),n(77,"Argumento de la pel\xEDcula"),t(),p(78,"input",26),c(79,Pe,2,0,"mat-error",6)(80,je,2,0),t(),c(81,Be,7,1,"mat-form-field",3)(82,Ue,7,1,"mat-form-field",3),r(83,"button",27)(84,"mat-icon"),n(85,"save"),t(),n(86," Grabar "),t()()()()()),a&2&&(d(),u(1,i.idMedia?2:1),d(6),f("formGroup",i.frmMedia),d(9),u(16,i.titulo.errors!=null&&i.titulo.errors.required?16:i.titulo.errors!=null&&i.titulo.errors.minlength?17:-1),d(6),u(22,i.imagen.errors!=null&&i.imagen.errors.required?22:-1),d(7),f("formControl",i.actorList),d(),y(i.actLocal),d(4),f("ngIf",i.actores.controls.length<3),d(5),f("ngForOf",V(40,16,i.actores.controls)),d(10),u(49,i.tipo.errors!=null&&i.tipo.errors.required?49:-1),d(5),u(54,i.director.errors!=null&&i.director.errors.required?54:i.director.errors!=null&&i.director.errors.minlength?55:-1),d(6),u(60,i.anyo.errors!=null&&i.anyo.errors.required?60:i.anyo.errors!=null&&i.anyo.errors.min?61:i.anyo.errors!=null&&i.anyo.errors.max?62:-1),d(7),u(67,i.puntuacion.errors!=null&&i.puntuacion.errors.required?67:i.puntuacion.errors!=null&&i.puntuacion.errors.min?68:i.puntuacion.errors!=null&&i.puntuacion.errors.max?69:-1),d(7),u(74,i.genero.errors!=null&&i.genero.errors.required?74:-1),d(5),u(79,i.descripcion.errors!=null&&i.descripcion.errors.required?79:i.descripcion.errors!=null&&i.descripcion.errors.minlength?80:-1),d(2),u(81,i.isPelicula?81:-1),d(),u(82,i.isSerie?82:-1),d(),f("disabled",i.frmMedia.invalid))},dependencies:[ee,G,W,X,O,$,Q,R,B,Y,te,J,U,K,H,fe,le,ne,ae,me,de,se,ce,z,D,L,k,re,ie,pe,ue,oe]});let e=l;return e})();export{ft as MediaFrmComponent};
